-- Author: Drew Kovacs, Technical Clerk
-- Purpose: Pulls students who have a max VA certification term equal to 201980 in SGASTDN

SELECT DISTINCT
  SPRIDEN.SPRIDEN_ID AS "STUDENT ID",
  SPRIDEN.SPRIDEN_LAST_NAME AS "LAST_NAME",
  SPRIDEN.SPRIDEN_FIRST_NAME AS "FIRST_NAME",
  STVVETC_DESC AS "Chapter",
  max (SGRVETN_TERM_CODE_VA) as "Max Certification Term"
  
  
  
FROM SPRIDEN,
  STVVETC,
  SGRVETN
  
  
WHERE 
SPRIDEN_PIDM = SGRVETN_PIDM
AND spriden_change_ind IS NULL
AND STVVETC_CODE = SGRVETN_VETC_CODE


group by SPRIDEN.SPRIDEN_ID, SPRIDEN.SPRIDEN_LAST_NAME, SPRIDEN.SPRIDEN_FIRST_NAME, STVVETC_DESC

having max (SGRVETN_TERM_CODE_VA) = 201980

ORDER BY SPRIDEN.SPRIDEN_LAST_NAME,
  SPRIDEN.SPRIDEN_FIRST_NAME;