--Author:  Kevin Thomas, Assistant Registrar
--Date:    06-MAR-2019
--Purpos:  This query finds courses from TBR CCs that have groups in the Transfer Block of SHATATR

--desc shbtatc;  --Transfer College Course Info on SHATATR; top block
--desc shrtatc;  --Institutional Transfer Table; middle block


SELECT SHBTATC.SHBTATC_SBGI_CODE,
  CASE
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '001081'
    THEN 'Columbia_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '002266'
    THEN 'Jackson_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '002848'
    THEN 'Cleveland_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '007323'
    THEN 'Dyersburg_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '001543'
    THEN 'Motlow_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '001893'
    THEN 'Walters_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '001881'
    THEN 'Volunteer_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '001656'
    THEN 'Roane_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '001084'
    THEN 'Chattanooga State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '000274'
    THEN 'Southwest'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '000453'
    THEN 'Northwest_State'
    WHEN SHRTATC.SHRTATC_SBGI_CODE = '000319'
    THEN 'Pellissippi'
    ELSE NULL
  END AS "Institution",
  SHBTATC.SHBTATC_SUBJ_CODE_TRNS,
  SHBTATC.SHBTATC_CRSE_NUMB_TRNS,
  SHBTATC.SHBTATC_GROUP,
  SHBTATC.SHBTATC_ACTIVITY_DATE,
  SHBTATC.SHBTATC_TRNS_LOW_HRS,
  SHBTATC.SHBTATC_TRNS_HIGH_HRS,
  SHBTATC.SHBTATC_TRNS_REVIEW_IND,
  SHBTATC.SHBTATC_GROUP_PRIMARY_IND,
  SHRTATC.SHRTATC_SBGI_CODE
FROM SHBTATC,
  SHRTATC
WHERE SHRTATC.SHRTATC_SBGI_CODE     = SHBTATC.SHBTATC_SBGI_CODE
AND SHBTATC.SHBTATC_SBGI_CODE      IN ('00319', '00453', '00274', '001084', '001656', '001881', '001893', '001543', '007323', '002848', '002266', '001081')
AND SHBTATC.SHBTATC_GROUP          <> 'null'
AND SHBTATC.SHBTATC_SUBJ_CODE_TRNS  = SHRTATC.SHRTATC_SUBJ_CODE_TRNS
AND SHBTATC.SHBTATC_CRSE_NUMB_TRNS =  SHRTATC.SHRTATC_CRSE_NUMB_TRNS