--Author:  Unknown - found in the "Lance for Melissa" file - no author listed
--Date:    Unknown
--Purpose: Use this script to find grades by term...specifically "I" grades.  




Select
  SPRIDEN_ID as "ID", SPRIDEN_LAST_NAME as "Last Name",SPRIDEN_FIRST_NAME as "First Name",MASTER.SHRTCKN_TERM_CODE as "Term", MASTER.SHRTCKN_CRN as "CRN", 
  MASTER.SHRTCKN_SUBJ_CODE || ' ' || MASTER.SHRTCKN_CRSE_NUMB AS "Course", MASTER.SHRTCKN_SEQ_NUMB AS "Section",
  MASTER.SHRTCKN_CRSE_TITLE as "Title",
  SHRTCKG_GRDE_CODE_FINAL as "Grade", SHRTCKG_GMOD_CODE as "Grade Mode"
  FROM
    SHRTCKG, SPRIDEN,
    (Select
        SHRTCKN_PIDM,
        SHRTCKN_TERM_CODE,SHRTCKN_SEQ_NO,SHRTCKG_TCKN_SEQ_NO,
        SHRTCKN_CRN,
        SHRTCKN_SUBJ_CODE,SHRTCKN_CRSE_NUMB,SHRTCKN_SEQ_NUMB,
        SHRTCKN_CRSE_TITLE,
        MAX(SHRTCKG_SEQ_NO) AS SHRTCKG_SEQ_NO_MAX
        FROM
        SHRTCKG, SHRTCKN
        WHERE
            SHRTCKG_pidm = SHRTCKN_pidm
        AND SHRTCKG_TERM_CODE = SHRTCKN_TERM_CODE
        AND SHRTCKG_TCKN_SEQ_NO = SHRTCKN_SEQ_NO
        AND SHRTCKN_TERM_CODE = :Term
        --AND SHRTCKN_SUBJ_CODE = 'PSYC'
        --AND SHRTCKN_CRSE_NUMB = '2111'
        GROUP BY 
        SHRTCKN_PIDM,
        SHRTCKN_TERM_CODE,SHRTCKN_SEQ_NO,SHRTCKG_TCKN_SEQ_NO,
        SHRTCKN_CRN,
        SHRTCKN_SUBJ_CODE,SHRTCKN_CRSE_NUMB,SHRTCKN_SEQ_NUMB,
        SHRTCKN_CRSE_TITLE) MASTER
  WHERE
        SHRTCKG_pidm = MASTER.SHRTCKN_pidm
    AND MASTER.SHRTCKN_pidm = SPRIDEN_PIDM
    AND SPRIDEN_CHANGE_IND IS NULL 
    AND SHRTCKG_TERM_CODE = MASTER.SHRTCKN_TERM_CODE
    AND SHRTCKG.SHRTCKG_TCKN_SEQ_NO = MASTER.SHRTCKN_SEQ_NO
    AND SHRTCKG.SHRTCKG_SEQ_NO = MASTER.SHRTCKG_SEQ_NO_MAX
    --AND SPRIDEN_ID IN ('A00357197')
    AND SHRTCKG_GRDE_CODE_FINAL = :Grade
  ORDER BY SHRTCKN_SUBJ_CODE,SHRTCKN_CRSE_NUMB,SHRTCKN_SEQ_NUMB,SPRIDEN_LAST_NAME,SPRIDEN_FIRST_NAME;